\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{main}
\RequirePackage{titlesec,fancyvrb,framed,hyperref,xepersian}

%% Render <200c> for pandoc before 2.19 relase
\let\textormath=\TextOrMath

%% link colors
\hypersetup{
    colorlinks=true,
    linkcolor={blue!55!black},
    citecolor={red!65!black},
    urlcolor={green!35!black},
}

%% custom section
\titleformat{\section}
    {\LARGE \secfont \bfseries}
    {\thesection.}
    {.03\linewidth}
    {}%
    [{\titlerule[0pt]}]
%% custom subsection
\titleformat{\subsection}
    {\Large \secfont \bfseries}
    {\thesubsection.}
    {.03\linewidth}
    {}%
    [{\titlerule[0pt]}]
%% custom subsubsection
\titleformat{\subsubsection}
    {\large \secfont \bfseries}
    {\thesubsubsection.}
    {.03\linewidth}
    {}%
    [{\titlerule[0pt]}]

%% headings position
\titlespacing{\section}{0mm}{5mm}{5mm}
\titlespacing{\subsection}{0mm}{5mm}{5mm}
\titlespacing{\subsubsection}{0pt}{5mm}{5mm}

%% every h1 at a new page
%\let\oldsection\section
%\renewcommand\section{\newpage\oldsection}

%% default fonts:
\setmainfont{Libertinus Serif}
\setmathfont{Libertinus Sans}
\setsansfont{Fira Sans}
\setmonofont{Fira Mono Regular}

%% Persian fonts
%%% Special type
\defpersianfont\sayeh{HMXKayhanSayeh}
%\defpersianfont\nast{IranNastaliq}
%\defpersianfont\titr{HMXTitr}
%%% Serif type
%\defpersianfont\yas{Yas}
%\defpersianfont\persianmodern{Persian Modern}
%\defpersianfont\naskh{Noto Naskh Arabic}
%%% Sans-serif type
%\defpersianfont\yekan{XM Yekan}

\settextfont[Scale=1.1]{HMFNazli}
\setdigitfont[Scale=1.1]{HMFNazli}
\defpersianfont\secfont{HMXKayhan}
\defpersianfont\qfont{Vazir}

\setlatintextfont{Libertinus Serif}
\setlatinsansfont{Fira Sans}
\setlatinmonofont{Fira Mono Regular}
%\setlatinmonofont{Inconsolata}

%% add line number to code-blocks
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\},frame=single}
%\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\},numbers=left}
%\DefineVerbatimEnvironment{Verb}{Verbatim}{numbers=left}
%\DefineVerbatimEnvironment{verbatim}{Verbatim}{numbers=left}

%\ifcsname Shaded\endcsname
\ifdefined\Shaded
    \renewenvironment{Shaded}%
        {\begin{latin}\begin{snugshade}}%
        {\end{snugshade}\end{latin}}
\else
    \newenvironment{Shaded}%
        {\begin{latin}\begin{snugshade}}%
        {\end{snugshade}\end{latin}}
\fi

%% quotation
\renewenvironment{quote}%
	{\begin{quotation}\qfont«\hspace{-0.5mm}}%
	{\hspace{-0.5mm}»\end{quotation}}
%    {\begin{center}\begin{tabular}{|p{.8\textwidth}}\qfont}%
%    {\end{tabular}\end{center}}

%% Simple verbatim
\let\oldverbatim=\verbatim
\let\oldendverbatim=\endverbatim
\renewenvironment{verbatim}%
    {\begin{quotation}\begin{latin}\oldverbatim\noindent}%
    {\oldendverbatim \end{latin}\end{quotation}}

%% line-space
\linespread{1.5}

%% Paragraph indentation
\setlength{\parindent}{15pt}
%\setlength\parindent{\defaultparindent}
